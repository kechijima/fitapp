import{_ as z}from"./tY4uFk0w.js";import{g as U,r as y,c as a,a as e,t as d,k as l,F as w,B as b,o as n,C as G,p as h,D as x,j as J,E as O,b as E,w as B,m as P,v as Q,q as j,n as R,T as X,d as F}from"./WFAcvMe-.js";import{_ as Y}from"./DlAUqK2U.js";import{u as H}from"./BXMDA6kW.js";const K={class:"calendar-card"},Z={class:"calendar-header"},tt={class:"calendar-grid"},et=["onClick"],st={key:0},ot={key:1,class:"dot"},at=U({__name:"WorkoutCalendar",props:{workoutDates:{}},emits:["select-date"],setup(T,{emit:$}){const L=T,p=$,C=new Date,r=y(C.getMonth()),i=y(C.getFullYear()),m=["1æœˆ","2æœˆ","3æœˆ","4æœˆ","5æœˆ","6æœˆ","7æœˆ","8æœˆ","9æœˆ","10æœˆ","11æœˆ","12æœˆ"],k=(v,f)=>new Date(v,f+1,0).getDate(),N=(v,f)=>new Date(v,f,1).getDay(),V=x(()=>{const v=[],f=N(i.value,r.value),u=k(i.value,r.value);for(let _=0;_<f;_++)v.push({day:null,fullDate:null});for(let _=1;_<=u;_++){const S=_.toString().padStart(2,"0"),M=(r.value+1).toString().padStart(2,"0"),W=`${i.value}-${M}-${S}`;v.push({day:_,fullDate:W,hasWorkout:L.workoutDates.includes(W)})}return v}),q=()=>{r.value===0?(r.value=11,i.value--):r.value--},A=()=>{r.value===11?(r.value=0,i.value++):r.value++};return(v,f)=>(n(),a("div",K,[e("div",Z,[e("button",{onClick:q},"â€¹"),e("h2",null,d(l(i))+"å¹´ "+d(m[l(r)]),1),e("button",{onClick:A},"â€º")]),e("div",tt,[(n(),a(w,null,b(["æ—¥","æœˆ","ç«","æ°´","æœ¨","é‡‘","åœŸ"],u=>e("div",{class:"day-label",key:u},d(u),1)),64)),(n(!0),a(w,null,b(l(V),(u,_)=>(n(),a("div",{key:_,class:G(["calendar-day",{"has-workout":u.hasWorkout,empty:!u.day}]),onClick:S=>u.fullDate&&p("select-date",u.fullDate)},[u.day?(n(),a("span",st,d(u.day),1)):h("",!0),u.hasWorkout?(n(),a("div",ot)):h("",!0)],10,et))),128))])]))}}),nt=Y(at,[["__scopeId","data-v-04b9fd80"]]),lt={class:"workouts-container"},it={class:"header"},rt={class:"dashboard-grid"},ct={class:"sidebar"},dt={class:"stats-card"},ut={class:"combobox-container"},vt={key:0,class:"chips-area"},_t=["onClick"],mt=["onClick"],ht={key:0,class:"dropdown-empty"},pt={key:0,class:"empty-stats"},ft={class:"stat-name"},kt={class:"stat-values"},yt={class:"stat-item"},gt={class:"value"},xt={class:"stat-item"},wt={class:"value"},bt={class:"main-content"},Ct={class:"section-header"},Dt={class:"title-with-badge"},$t={key:0,class:"filter-badge"},St={key:0,class:"loading"},Mt={key:1,class:"empty"},Wt={key:2,class:"workout-list"},Et={class:"card-main"},Ft={class:"card-info"},Lt={class:"date"},Nt={class:"exercise-title"},Vt={class:"card-sets"},qt={key:0,class:"set-chips"},At={class:"weight"},Bt={class:"reps"},Tt={key:0,class:"set-more",title:"ã•ã‚‰ã«è¡¨ç¤º"},It={key:1,class:"summary-line"},jt={class:"summary-item"},Ut={class:"summary-item"},Yt={class:"summary-item"},zt={class:"card-actions"},Gt=["onClick"],Jt={key:0,class:"card-note"},Ot=U({__name:"index",setup(T){const $=H(),L=J(),p=y([]),C=y(!0),r=y(null),i=y([]),m=y(""),k=y(!1),N=async()=>{C.value=!0;const{data:o,error:t}=await $.from("workouts").select("*, workout_sets(*)").order("date",{ascending:!1});o&&(p.value=o),C.value=!1},V=async o=>{if(!confirm("æœ¬å½“ã«å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ"))return;const{error:t}=await $.from("workouts").delete().eq("id",o);t||(p.value=p.value.filter(c=>c.id!==o))},q=x(()=>{const o=new Map;return p.value.forEach(t=>{o.has(t.exercise_name)||o.set(t.exercise_name,{max:0,totalWeight:0,setCount:0});const c=o.get(t.exercise_name);if(t.workout_sets&&t.workout_sets.length>0)t.workout_sets.forEach(g=>{const s=g.weight||0;s>c.max&&(c.max=s),c.totalWeight+=s,c.setCount++});else{const g=t.weight||0;g>c.max&&(c.max=g),c.totalWeight+=g,c.setCount++}}),Array.from(o.entries()).map(([t,c])=>({name:t,max:c.max,avg:c.setCount>0?Math.round(c.totalWeight/c.setCount*10)/10:0}))}),A=x(()=>Array.from(new Set(p.value.map(o=>o.exercise_name))).sort()),v=x(()=>{let o=q.value;if(m.value){const t=m.value.toLowerCase();o=o.filter(c=>c.name.toLowerCase().includes(t))}return i.value.length>0?o.filter(t=>i.value.includes(t.name)):o}),f=x(()=>{const o=m.value.toLowerCase();return A.value.filter(t=>!i.value.includes(t)&&t.toLowerCase().includes(o))}),u=o=>{i.value.push(o),m.value="",k.value=!1},_=o=>{i.value=i.value.filter(t=>t!==o)},S=x(()=>[...new Set(p.value.map(o=>o.date))]),M=x(()=>{let o=p.value;return r.value&&(o=o.filter(t=>t.date===r.value)),i.value.length>0&&(o=o.filter(t=>i.value.includes(t.exercise_name))),o}),W=()=>{r.value=null,i.value=[],m.value=""};O(()=>{L.value&&N()});const I=o=>new Date(o).toLocaleDateString("ja-JP");return(o,t)=>{const c=z,g=nt;return n(),a("div",lt,[e("div",it,[t[7]||(t[7]=e("h1",null,"ãƒ¯ãƒ¼ã‚¯ã‚¢ã‚¦ãƒˆ",-1)),E(c,{to:`/workouts/add${l(r)?"?date="+l(r):""}`,class:"btn btn-add"},{default:B(()=>[...t[6]||(t[6]=[F("ï¼‹ è¨˜éŒ²ã™ã‚‹",-1)])]),_:1},8,["to"])]),e("div",rt,[e("div",ct,[E(g,{"workout-dates":l(S),onSelectDate:t[0]||(t[0]=s=>r.value=l(r)===s?null:s),class:"mb-6"},null,8,["workout-dates"]),e("div",dt,[t[10]||(t[10]=e("div",{class:"stats-header-row"},[e("h3",null,"ç¨®ç›®åˆ¥çµ±è¨ˆ (ãƒ•ã‚£ãƒ«ã‚¿è¡¨ç¤º)")],-1)),e("div",ut,[e("div",{class:"combobox-input-wrapper",onClick:t[4]||(t[4]=s=>k.value=!l(k))},[l(i).length>0?(n(),a("div",vt,[(n(!0),a(w,null,b(l(i),s=>(n(),a("span",{key:s,class:"filter-chip"},[F(d(s)+" ",1),e("button",{onClick:j(D=>_(s),["stop"]),class:"chip-remove"},"Ã—",8,_t)]))),128))])):h("",!0),P(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>R(m)?m.value=s:null),placeholder:"ç¨®ç›®ã‚’é¸æŠ...",class:"combobox-input",onFocus:t[2]||(t[2]=s=>k.value=!0),onClick:t[3]||(t[3]=j(()=>{},["stop"]))},null,544),[[Q,l(m)]])]),E(X,{name:"fade"},{default:B(()=>[l(k)?(n(),a("div",{key:0,class:"combobox-dropdown",onMouseleave:t[5]||(t[5]=s=>k.value=!1)},[(n(!0),a(w,null,b(l(f),s=>(n(),a("div",{key:s,class:"dropdown-item",onClick:D=>u(s)},d(s),9,mt))),128)),l(f).length===0?(n(),a("div",ht," å€™è£œãŒã‚ã‚Šã¾ã›ã‚“ ")):h("",!0)],32)):h("",!0)]),_:1})]),t[11]||(t[11]=e("div",{class:"stats-divider"},null,-1)),l(v).length===0?(n(),a("div",pt," è¡¨ç¤ºã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“ ")):h("",!0),(n(!0),a(w,null,b(l(v),s=>(n(),a("div",{key:s.name,class:"stat-row"},[e("div",ft,d(s.name),1),e("div",kt,[e("div",yt,[t[8]||(t[8]=e("span",{class:"label"},"MAX",-1)),e("span",gt,d(s.max)+"kg",1)]),e("div",xt,[t[9]||(t[9]=e("span",{class:"label"},"AVG",-1)),e("span",wt,d(s.avg)+"kg",1)])])]))),128))])]),e("div",bt,[e("div",Ct,[e("div",Dt,[e("h2",null,d(l(r)?I(l(r)):l(i).length>0?"çµã‚Šè¾¼ã¿ä¸­":"ã™ã¹ã¦ã®å±¥æ­´"),1),l(r)||l(i).length>0?(n(),a("span",$t,d(l(i).length>0?l(i).length+"ç¨®ç›®":"")+" ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ä¸­ ",1)):h("",!0)]),l(r)||l(i).length>0?(n(),a("button",{key:0,onClick:W,class:"btn-text"},"ã™ã¹ã¦è¡¨ç¤º")):h("",!0)]),l(C)?(n(),a("div",St,"èª­ã¿è¾¼ã¿ä¸­...")):l(M).length===0?(n(),a("div",Mt,[...t[12]||(t[12]=[e("div",{class:"empty-icon"},"ğŸ“‚",-1),e("p",null,"è©²å½“ã™ã‚‹è¨˜éŒ²ãŒã‚ã‚Šã¾ã›ã‚“",-1)])])):(n(),a("div",Wt,[(n(!0),a(w,null,b(l(M),s=>(n(),a("div",{key:s.id,class:"workout-card compact"},[e("div",Et,[e("div",Ft,[e("span",Lt,d(I(s.date)),1),e("h3",Nt,d(s.exercise_name),1)]),e("div",Vt,[s.workout_sets?(n(),a("div",qt,[(n(!0),a(w,null,b(s.workout_sets.slice(0,3),D=>(n(),a("div",{key:D.id,class:"set-chip"},[e("span",At,[F(d(D.weight),1),t[13]||(t[13]=e("small",null,"kg",-1))]),e("span",Bt,"Ã—"+d(D.reps),1)]))),128)),s.workout_sets.length>3?(n(),a("div",Tt,"...")):h("",!0)])):(n(),a("div",It,[e("span",jt,"âš–ï¸ "+d(s.weight)+"kg",1),e("span",Ut,"ğŸ“Š "+d(s.sets)+"s",1),e("span",Yt,"ğŸ” "+d(s.reps)+"r",1)]))]),e("div",zt,[E(c,{to:`/workouts/edit/${s.id}`,class:"icon-btn",title:"ç·¨é›†"},{default:B(()=>[...t[14]||(t[14]=[F("âœï¸",-1)])]),_:1},8,["to"]),e("button",{onClick:D=>V(s.id),class:"icon-btn del",title:"å‰Šé™¤"},"ğŸ—‘ï¸",8,Gt)])]),s.note?(n(),a("p",Jt,d(s.note),1)):h("",!0)]))),128))]))])])])}}}),Ht=Y(Ot,[["__scopeId","data-v-4cbb97ef"]]);export{Ht as default};
