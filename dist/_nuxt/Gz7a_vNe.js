import{_ as L}from"./tY4uFk0w.js";import{_ as $,u as z}from"./jxPz-m0W.js";import{g as F,y as G,x as H,z as P,G as j,c as m,a as e,m as h,A as J,k as n,n as U,F as T,B as N,v as g,b as R,w as K,r as i,o as p,t as q,C as O,q as B,p as Q,d as X}from"./WFAcvMe-.js";import{u as Y}from"./BXMDA6kW.js";import{_ as Z}from"./DlAUqK2U.js";const ee={class:"add-container"},te={class:"main-layout"},se={class:"form-section"},oe={class:"form-card"},ae={class:"form-group"},ne={class:"select-wrapper"},re=["value"],le={class:"sets-list"},ie=["onClick"],ue={class:"set-number"},ce=["onUpdate:modelValue"],de=["onUpdate:modelValue"],_e={class:"set-actions"},me=["onClick"],pe=["onClick"],ve={class:"form-group note-area"},we={class:"textarea-wrapper"},fe={class:"actions"},he=["disabled"],ke={class:"timer-section"},be=F({__name:"[id]",async setup(ge){let w,y;const I=G(),C=H(),u=Y(),f=I.params.id,{data:x}=([w,y]=P(async()=>z("exercises",async()=>{const{data:t}=await u.from("exercises").select("*").order("name");return t||[]})),w=await w,y(),w),c=i(""),o=i([{weight:null,reps:null}]),v=i(""),k=i(!1),S=i(60),V=i(0),b=i(0);j(async()=>{const{data:t,error:s}=await u.from("workouts").select("*, workout_sets(*)").eq("id",f).single();t?(c.value=t.exercise_name,v.value=t.note||"",t.workout_sets&&t.workout_sets.length>0&&(o.value=t.workout_sets.sort((r,d)=>r.set_number-d.set_number).map(r=>({weight:r.weight,reps:r.reps}))),E()):s&&(alert("ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ: "+s.message),C.push("/workouts"))});const E=()=>{var s;const t=(s=x.value)==null?void 0:s.find(r=>r.name===c.value);t&&(t.default_rest_time&&(S.value=t.default_rest_time),t.default_work_time!==void 0&&(V.value=t.default_work_time))},M=()=>{const t=o.value[o.value.length-1];o.value.push({weight:t.weight,reps:t.reps})},W=t=>{t>0&&(o.value[t].weight=o.value[t-1].weight,o.value[t].reps=o.value[t-1].reps)},A=t=>{o.value.length>1&&o.value.splice(t,1)},D=async()=>{const{data:{user:t}}=await u.auth.getUser();if(t){k.value=!0;try{const{error:s}=await u.from("workouts").update({exercise_name:c.value,note:v.value||null,weight:o.value[0].weight,reps:o.value[0].reps,sets:o.value.length}).eq("id",f);if(s)throw s;await u.from("workout_sets").delete().eq("workout_id",f);const r=o.value.map((a,l)=>({workout_id:f,set_number:l+1,weight:a.weight,reps:a.reps})),{error:d}=await u.from("workout_sets").insert(r);if(d)throw d;C.push("/workouts")}catch(s){alert("æ›´æ–°ã«å¤±æ•—ã—ã¾ã—ãŸ: "+s.message)}finally{k.value=!1}}};return(t,s)=>{const r=L,d=$;return p(),m("div",ee,[s[6]||(s[6]=e("div",{class:"header"},[e("h1",null,"âœï¸ è¨˜éŒ²ã‚’ç·¨é›†"),e("p",{class:"subtitle"},"ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°å†…å®¹ã‚’ä¿®æ­£ã—ã¾ã™")],-1)),e("div",te,[e("div",se,[e("div",oe,[e("div",ae,[s[2]||(s[2]=e("label",{for:"exercise"},"ç¨®ç›®ã‚’é¸æŠž *",-1)),e("div",ne,[h(e("select",{id:"exercise","onUpdate:modelValue":s[0]||(s[0]=a=>U(c)?c.value=a:null),required:"",class:"select-input",onChange:E},[(p(!0),m(T,null,N(n(x),a=>(p(),m("option",{key:a.id,value:a.name},q(a.name),9,re))),128))],544),[[J,n(c)]])])]),s[5]||(s[5]=e("div",{class:"sets-header"},[e("span",null,"SET"),e("span",null,"WEIGHT (kg)"),e("span",null,"REPS"),e("span")],-1)),e("div",le,[(p(!0),m(T,null,N(n(o),(a,l)=>(p(),m("div",{key:l,class:O(["set-row",{"current-focus":n(b)===l}]),onClick:_=>b.value=l},[e("div",ue,q(l+1),1),h(e("input",{type:"number",step:"0.5",min:"0","onUpdate:modelValue":_=>a.weight=_},null,8,ce),[[g,a.weight]]),h(e("input",{type:"number",min:"0","onUpdate:modelValue":_=>a.reps=_},null,8,de),[[g,a.reps]]),e("div",_e,[e("button",{type:"button",onClick:B(_=>W(l),["stop"]),class:"btn-icon"},"ðŸ“‹",8,me),n(o).length>1?(p(),m("button",{key:0,type:"button",onClick:B(_=>A(l),["stop"]),class:"btn-icon btn-delete"},"Ã—",8,pe)):Q("",!0)])],10,ie))),128))]),e("button",{type:"button",onClick:M,class:"btn btn-add-set"},"ï¼‹ ã‚»ãƒƒãƒˆã‚’è¿½åŠ "),e("div",ve,[s[3]||(s[3]=e("label",{for:"note",class:"note-label"},"âœï¸ ãƒ¡ãƒ¢",-1)),e("div",we,[h(e("textarea",{id:"note","onUpdate:modelValue":s[1]||(s[1]=a=>U(v)?v.value=a:null),rows:"3"},null,512),[[g,n(v)]])])]),e("div",fe,[e("button",{onClick:D,class:"btn btn-submit",disabled:n(k)},"æ›´æ–°ã‚’ä¿å­˜",8,he),R(r,{to:"/workouts",class:"btn btn-cancel"},{default:K(()=>[...s[4]||(s[4]=[X("ã‚­ãƒ£ãƒ³ã‚»ãƒ«",-1)])]),_:1})])])]),e("div",ke,[R(d,{"default-rest-time":n(S),"default-work-time":n(V),"current-set":n(b)+1,"total-sets":n(o).length},null,8,["default-rest-time","default-work-time","current-set","total-sets"])])])])}}}),Ee=Z(be,[["__scopeId","data-v-aa82b254"]]);export{Ee as default};
